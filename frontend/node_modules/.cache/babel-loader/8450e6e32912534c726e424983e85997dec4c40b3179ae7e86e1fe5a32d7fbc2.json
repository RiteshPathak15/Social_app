{"ast":null,"code":"import React,{useState,useEffect}from'react';import Navbar from'./Navbar';import'../CSS/Notice.css';import{toast,ToastContainer}from'react-toastify';import{useNavigate}from'react-router-dom';import AllNotice from'./screens/AllNotice';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Notice(){const[imageSrc,setImageSrc]=useState('');const[category,setcategory]=useState('');const storedDataString=localStorage.getItem('token');const storedData=JSON.parse(storedDataString);const[body,setBody]=useState(\"\");const[image,setImage]=useState(\"\");const[url,setUrl]=useState(\"\");const navigate=useNavigate();// Toast functions\nconst notifyA=msg=>toast.error(msg);const notifyB=msg=>toast.success(msg);const postNotice=()=>{document.getElementById('notice-form-container').style.display='block';};const close=()=>{document.getElementById('notice-form-container').style.display='none';};// posting image to cloudinary\nconst postDetails=()=>{console.log(category);console.log(body,image);const data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"Social\");data.append(\"cloud_name\",\"Pillai-ig\");fetch(\"https://api.cloudinary.com/v1_1/Pillai-ig/image/upload\",{method:\"post\",body:data}).then(res=>res.json()).then(data=>setUrl(data.url)).catch(err=>console.log(err));console.log(data);console.log(url);// console.log(localStorage.getItem(storedData.token))\n};const loadfile=event=>{const file=event.target.files[0];const url=URL.createObjectURL(file);setImageSrc(url);// Optionally, if you want to free memory when the component unmounts\nreturn()=>URL.revokeObjectURL(url);};useEffect(()=>{// saving post to mongodb\nif(url){if(url){// console.log(storedData.token);\nfetch(\"/Notice\",{method:\"post\",headers:{\"Content-Type\":\"application/json\",\"authorization\":\"Bearer \"+storedData.token},body:JSON.stringify({body,pic:url})}).then(res=>res.json()).then(data=>{if(data.error){notifyA(data.error);}else{notifyB(\"Successfully Posted\");window.location.reload();// navigate(\"/Notice\")\n}}).catch(err=>console.log(err));}}},[url]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{id:\"notices-container\",className:\"notices-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"College Notice Board\"}),/*#__PURE__*/_jsx(\"button\",{id:\"post_notice\",onClick:()=>{postNotice();},children:\"POST NOTICE\"}),/*#__PURE__*/_jsx(\"div\",{id:\"noticeList\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{id:\"notice-form-container\",children:[/*#__PURE__*/_jsx(\"i\",{class:\"bx bx-window-close\",onClick:()=>{close();},children:\"Close\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"noticeText\",children:\"Add Notice:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:body,onChange:e=>{setBody(e.target.value);},className:\"form-control\",id:\"noticeText\",rows:\"3\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"uploadImage\",children:\"Upload Image (Optional):\"}),/*#__PURE__*/_jsx(\"img\",{src:imageSrc||'https://static.thenounproject.com/png/777906-200.png',id:\"output\",alt:\"Uploaded\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:event=>{loadfile(event);setImage(event.target.files[0]);},name:\"uploadImage\",id:\"uploadImage\",accept:\"image/*\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:()=>{postDetails();},className:\"btn btn-primary\",children:\"Post Notice\"})]}),/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(AllNotice,{})]});}","map":{"version":3,"names":["React","useState","useEffect","Navbar","toast","ToastContainer","useNavigate","AllNotice","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Notice","imageSrc","setImageSrc","category","setcategory","storedDataString","localStorage","getItem","storedData","JSON","parse","body","setBody","image","setImage","url","setUrl","navigate","notifyA","msg","error","notifyB","success","postNotice","document","getElementById","style","display","close","postDetails","console","log","data","FormData","append","fetch","method","then","res","json","catch","err","loadfile","event","file","target","files","URL","createObjectURL","revokeObjectURL","headers","token","stringify","pic","window","location","reload","children","id","className","onClick","class","htmlFor","value","onChange","e","rows","required","src","alt","type","name","accept"],"sources":["C:/Users/pursh/OneDrive/Desktop/college/backend/frontend/src/pages/Notice.js"],"sourcesContent":["import React, { useState,useEffect } from 'react';\r\nimport Navbar from './Navbar';\r\nimport '../CSS/Notice.css';\r\nimport { toast,ToastContainer } from 'react-toastify';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport AllNotice from './screens/AllNotice';\r\nexport default function Notice() {\r\n  const [imageSrc, setImageSrc] = useState('');\r\n  const [category, setcategory] = useState('');\r\n  const storedDataString = localStorage.getItem('token');\r\n  const storedData = JSON.parse(storedDataString);\r\n  const [body, setBody] = useState(\"\");\r\n  const [image, setImage] = useState(\"\")\r\n  const [url, setUrl] = useState(\"\")\r\n  const navigate = useNavigate()\r\n\r\n  // Toast functions\r\n  const notifyA = (msg) => toast.error(msg)\r\n  const notifyB = (msg) => toast.success(msg)\r\n  const postNotice=()=>{\r\n    document.getElementById('notice-form-container').style.display='block';\r\n  }\r\n  const close=()=>{\r\n    document.getElementById('notice-form-container').style.display='none';\r\n  }\r\n\r\n \r\n\r\n  // posting image to cloudinary\r\n  const postDetails = () => {\r\n    console.log(category);\r\n    console.log(body, image)\r\n    const data = new FormData()\r\n    data.append(\"file\", image)\r\n    data.append(\"upload_preset\", \"Social\")\r\n    data.append(\"cloud_name\", \"Pillai-ig\")\r\n    fetch(\"https://api.cloudinary.com/v1_1/Pillai-ig/image/upload\", {\r\n      method: \"post\",\r\n      body: data\r\n    }).then(res => res.json())\r\n      .then(data => setUrl(data.url))\r\n      .catch(err => console.log(err))\r\n      console.log(data)\r\n    console.log(url)\r\n    // console.log(localStorage.getItem(storedData.token))\r\n\r\n  }\r\n\r\n\r\n  const loadfile = (event) => {\r\n    const file = event.target.files[0];\r\n    const url = URL.createObjectURL(file);\r\n    setImageSrc(url);\r\n\r\n    // Optionally, if you want to free memory when the component unmounts\r\n    return () => URL.revokeObjectURL(url);\r\n  };\r\n\r\n\r\n  \r\n  useEffect(() => {\r\n\r\n    // saving post to mongodb\r\n    if (url) {\r\n    \r\n      if (url) {\r\n    \r\n        // console.log(storedData.token);\r\n        fetch(\"/Notice\", {\r\n          method: \"post\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            \"authorization\": \"Bearer \" + storedData.token\r\n          },\r\n          body: JSON.stringify({\r\n            body,\r\n            pic: url\r\n          })\r\n        }).then(res => res.json())\r\n          .then(data => {\r\n            if (data.error) {\r\n              notifyA(data.error)\r\n            } else {\r\n              notifyB(\"Successfully Posted\")\r\n              window.location.reload();\r\n              // navigate(\"/Notice\")\r\n            }\r\n          })\r\n          .catch(err => console.log(err))\r\n      }\r\n  \r\n    } \r\n  },[url])\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <div id='notices-container' className=\"notices-container\">\r\n        <h2>College Notice Board</h2>\r\n        <button id='post_notice' onClick={()=>{postNotice()}} >POST NOTICE</button>\r\n        <div id=\"noticeList\"></div>\r\n      </div>\r\n      <hr />\r\n      <div id=\"notice-form-container\">\r\n        {/* <form id=\"addNoticeForm\" > */}\r\n       <i class='bx bx-window-close' onClick={()=>{close()}}>Close</i>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"noticeText\">Add Notice:</label>\r\n            <textarea value={body} onChange={(e) => {\r\n          setBody(e.target.value) }}className=\"form-control\" id=\"noticeText\" rows=\"3\" required></textarea>\r\n          </div>\r\n          {/* <div className=\"form-group\">\r\n          <label for=\"dropdownInput\">Select an option:</label>\r\n                <select id=\"dropdownInput\" value={category}  onChange={(e) => {\r\n          setcategory(e.target.value) }} name=\"dropdownInput\">\r\n                    <option value=\"Academic\" >Academic</option>\r\n                    <option value=\"Association\">Association</option>\r\n                    <option value=\"PerformingArts\">Performing Arts</option>\r\n                    <option value=\"Sports\">Sports</option>\r\n                    \r\n                    {/* <!-- Add more options as needed --> */}\r\n                {/* </select> */}\r\n          {/* </div> */} \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"uploadImage\">Upload Image (Optional):</label>\r\n            <img src={imageSrc || 'https://static.thenounproject.com/png/777906-200.png'} id=\"output\" alt=\"Uploaded\" />\r\n            <input\r\n              type=\"file\"\r\n              onChange={(event) => {\r\n                loadfile(event);\r\n                setImage(event.target.files[0])\r\n              }}\r\n              name=\"uploadImage\"\r\n              id=\"uploadImage\"\r\n              accept=\"image/*\"\r\n            />\r\n          </div>\r\n          <button type=\"submit\" onClick={() => { postDetails() }} className=\"btn btn-primary\">\r\n            Post Notice\r\n          </button>\r\n        {/* </form> */}\r\n      </div>\r\n      <ToastContainer/>\r\n              <AllNotice/>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}